import{r as b,_ as z,g as O,R as s,d as N,e as g,P as u,j as e,a as _,C as $}from"./index-eOIa0b6b.js";import{C as G,a as H}from"./CCardBody-DHJXu1Vk.js";import{C as W}from"./CCardHeader-CND7wYYM.js";import{C as J}from"./CForm-CtvG5_99.js";import{C as o,a as r}from"./CRow-DhPEjJNM.js";import{C as R}from"./CFormSelect-BkiGqBpk.js";import{a as U,b as q,C as p}from"./CFormInput-C_22s-D5.js";import{C as M}from"./CFormTextarea-BRZmsH-e.js";var f=b.forwardRef(function(t,m){var y=t.className,c=t.button,D=t.feedback,A=t.feedbackInvalid,F=t.feedbackValid,T=t.floatingLabel,d=t.tooltipFeedback,C=t.hitArea,h=t.id,x=t.indeterminate,w=t.inline,a=t.invalid,n=t.label,l=t.reverse,i=t.type,S=i===void 0?"checkbox":i,j=t.valid,v=z(t,["className","button","feedback","feedbackInvalid","feedbackValid","floatingLabel","tooltipFeedback","hitArea","id","indeterminate","inline","invalid","label","reverse","type","valid"]),k=b.useRef(null),B=O(m,k);b.useEffect(function(){k.current&&x&&(k.current.indeterminate=x)},[x,k.current]);var E=function(){return s.createElement("input",N({type:S,className:g(c?"btn-check":"form-check-input",{"is-invalid":a,"is-valid":j,"me-2":C}),id:h},v,{ref:B}))},P=function(){return s.createElement(q,{describedby:v["aria-describedby"],feedback:D,feedbackInvalid:A,feedbackValid:F,floatingLabel:T,invalid:a,tooltipFeedback:d,valid:j})},I=function(){var L;return s.createElement(U,N({customClassName:g(c?g("btn",c.variant?"btn-".concat(c.variant,"-").concat(c.color):"btn-".concat(c.color),(L={},L["btn-".concat(c.size)]=c.size,L),"".concat(c.shape)):"form-check-label")},h&&{htmlFor:h}),n)},V=function(){return c?s.createElement(s.Fragment,null,s.createElement(E,null),n&&s.createElement(I,null),s.createElement(P,null)):n?C?s.createElement(s.Fragment,null,s.createElement(E,null),s.createElement(U,N({customClassName:g("form-check-label stretched-link",y)},h&&{htmlFor:h}),n),s.createElement(P,null)):s.createElement("div",{className:g("form-check",{"form-check-inline":w,"form-check-reverse":l,"is-invalid":a,"is-valid":j},y)},s.createElement(E,null),s.createElement(I,null),s.createElement(P,null)):s.createElement(E,null)};return s.createElement(V,null)});f.propTypes=N({button:u.object,className:u.string,hitArea:u.oneOf(["full"]),id:u.string,indeterminate:u.bool,inline:u.bool,label:u.oneOfType([u.string,u.node]),reverse:u.bool,type:u.oneOf(["checkbox","radio"])},q.propTypes);f.displayName="CFormCheck";const ne=()=>{const[t,m]=b.useState({property:"",leaseUnits:!1,unit:"",rentPrice:"",depositPrice:"",tenant:"",tenantEmail:"",startDate:"",endDate:"",leaseDocuments:[],tenancyTerms:"",bills:{gas:!1,electricity:!1,internet:!1,tax:!1}}),[y,c]=b.useState([]),[D,A]=b.useState([]),[F,T]=b.useState([]);b.useEffect(()=>{(async()=>{try{const n=await fetch("http://localhost:5000/api/properties",{headers:{Authorization:`Bearer ${localStorage.getItem("authToken")}`}}),l=await fetch("http://localhost:5000/api/property-units",{headers:{Authorization:`Bearer ${localStorage.getItem("authToken")}`}}),i=await fetch("http://localhost:5000/api/tenants",{headers:{Authorization:`Bearer ${localStorage.getItem("authToken")}`}}),S=await n.json(),j=await l.json(),v=await i.json();c(S),A(j),T(v)}catch(n){console.error("Error fetching data:",n)}})()},[]);const d=a=>{const{name:n,value:l}=a.target;m(i=>({...i,[n]:l}))},C=a=>{const{name:n,checked:l}=a.target;m(i=>({...i,[n]:l,...n==="leaseUnits"&&{unit:""}}))},h=a=>{const{name:n,checked:l}=a.target;m(i=>({...i,bills:{...i.bills,[n]:l}}))},x=a=>{const n=Array.from(a.target.files);m(l=>({...l,leaseDocuments:n}))},w=async a=>{a.preventDefault();const n=new FormData;Object.keys(t).forEach(l=>{l==="bills"?Object.keys(t.bills).forEach(i=>{n.append(`bills[${i}]`,t.bills[i])}):l==="leaseDocuments"?t.leaseDocuments.forEach(i=>n.append("leaseDocuments",i)):n.append(l,t[l])});try{const l=await fetch("http://localhost:5000/api/leases",{method:"POST",body:n,headers:{Authorization:`Bearer ${localStorage.getItem("authToken")}`}});if(!l.ok)throw new Error(await l.text());alert("Lease created successfully!"),m({property:"",leaseUnits:!1,unit:"",rentPrice:"",depositPrice:"",tenant:"",tenantEmail:"",startDate:"",endDate:"",leaseDocuments:[],tenancyTerms:"",bills:{gas:!1,electricity:!1,internet:!1,tax:!1}})}catch(l){console.error(l),alert("Error creating lease.")}};return e.jsxs(_,{className:"mt-5",children:[e.jsx("h4",{className:"mb-4",children:"Create New Lease"}),e.jsxs(G,{children:[e.jsx(W,{children:e.jsx("strong",{children:"Lease Information"})}),e.jsx(H,{children:e.jsxs(J,{onSubmit:w,children:[e.jsxs(o,{className:"mb-3",children:[e.jsx(r,{md:6,children:e.jsxs(R,{name:"property",value:t.property,onChange:d,required:!0,children:[e.jsx("option",{value:"",children:"Select Property/Building"}),y.map(a=>e.jsx("option",{value:a.property_id,children:a.property_name},a.property_id))]})}),e.jsx(r,{md:6,children:e.jsx(f,{type:"checkbox",name:"leaseUnits",label:"Lease Units",checked:t.leaseUnits,onChange:C})})]}),t.leaseUnits&&e.jsx(o,{className:"mb-3",children:e.jsx(r,{md:12,children:e.jsxs(R,{name:"unit",value:t.unit,onChange:d,required:!0,children:[e.jsx("option",{value:"",children:"Select Unit"}),D.filter(a=>Number(a.property_id)===Number(t.property)&&a.status==="vacant").map(a=>e.jsxs("option",{value:a.property_unit_id,children:[a.unit_number," - ",a.unit_type]},a.property_unit_id))]})})}),e.jsxs(o,{className:"mb-3",children:[e.jsx(r,{md:6,children:e.jsx(p,{type:"number",name:"rentPrice",placeholder:"Rent Price (₱)",value:t.rentPrice,onChange:d,required:!0})}),e.jsx(r,{md:6,children:e.jsx(p,{type:"number",name:"depositPrice",placeholder:"Deposit Price (₱)",value:t.depositPrice,onChange:d,required:!0})})]}),e.jsxs(o,{className:"mb-3",children:[e.jsx(r,{md:6,children:e.jsxs(R,{name:"tenant",value:t.tenant,onChange:d,required:!0,children:[e.jsx("option",{value:"",children:"Select Tenant"}),F.map(a=>e.jsxs("option",{value:a.tenant_id,children:[a.first_name," ",a.last_name]},a.tenant_id))]})}),e.jsx(r,{md:6,children:e.jsx(p,{type:"email",name:"tenantEmail",placeholder:"Tenant Email",value:t.tenantEmail,onChange:d,required:!0})})]}),e.jsxs(o,{className:"mb-3",children:[e.jsx(r,{md:6,children:e.jsx(p,{type:"date",name:"startDate",placeholder:"Start Date of Lease",value:t.startDate,onChange:d,required:!0})}),e.jsx(r,{md:6,children:e.jsx(p,{type:"date",name:"endDate",placeholder:"End Date of Lease",value:t.endDate,onChange:d,required:!0})})]}),e.jsx(o,{className:"mb-3",children:e.jsxs(r,{md:12,children:[e.jsx(p,{type:"file",name:"leaseDocuments",multiple:!0,onChange:x,accept:".jpg,.png,.pdf",required:!0}),e.jsx("small",{className:"text-muted",children:"Upload lease documents. Accepted formats: jpg, png, pdf."})]})}),e.jsx(o,{className:"mb-3",children:e.jsx(r,{md:12,children:e.jsx(M,{name:"tenancyTerms",placeholder:"Tenancy Terms",rows:"3",value:t.tenancyTerms,onChange:d,required:!0})})}),e.jsx(o,{className:"mb-3",children:e.jsxs(r,{md:12,children:[e.jsx("strong",{children:"Bills:"}),e.jsxs(o,{className:"align-items-center mb-2",children:[e.jsx(r,{md:6,children:e.jsx(f,{type:"checkbox",name:"gas",label:"Gas",checked:t.bills.gas,onChange:h})}),e.jsx(r,{md:6,children:e.jsx(p,{type:"number",name:"gasAmount",placeholder:"Amount (₱)",value:t.bills.gasAmount||"",onChange:a=>{const n=a.target.value;n>=0&&m(l=>({...l,bills:{...l.bills,gasAmount:n}}))},min:"0"})})]}),e.jsxs(o,{className:"align-items-center mb-2",children:[e.jsx(r,{md:6,children:e.jsx(f,{type:"checkbox",name:"electricity",label:"Electricity",checked:t.bills.electricity,onChange:h})}),e.jsx(r,{md:6,children:e.jsx(p,{type:"number",name:"electricityAmount",placeholder:"Amount (₱)",value:t.bills.electricityAmount||"",onChange:a=>{const n=a.target.value;n>=0&&m(l=>({...l,bills:{...l.bills,electricityAmount:n}}))},min:"0"})})]}),e.jsxs(o,{className:"align-items-center mb-2",children:[e.jsx(r,{md:6,children:e.jsx(f,{type:"checkbox",name:"internet",label:"Internet",checked:t.bills.internet,onChange:h})}),e.jsx(r,{md:6,children:e.jsx(p,{type:"number",name:"internetAmount",placeholder:"Amount (₱)",value:t.bills.internetAmount||"",onChange:a=>{const n=a.target.value;n>=0&&m(l=>({...l,bills:{...l.bills,internetAmount:n}}))},min:"0"})})]}),e.jsxs(o,{className:"align-items-center mb-2",children:[e.jsx(r,{md:6,children:e.jsx(f,{type:"checkbox",name:"tax",label:"Tax",checked:t.bills.tax,onChange:h})}),e.jsx(r,{md:6,children:e.jsx(p,{type:"number",name:"taxAmount",placeholder:"Amount (₱)",value:t.bills.taxAmount||"",onChange:a=>{const n=a.target.value;n>=0&&m(l=>({...l,bills:{...l.bills,taxAmount:n}}))},min:"0"})})]})]})}),e.jsx("div",{className:"d-flex justify-content-end",children:e.jsx($,{type:"submit",style:{backgroundColor:"#F28D35",color:"white",fontWeight:"bold"},children:"Create Lease"})})]})})]})]})};export{ne as default};
