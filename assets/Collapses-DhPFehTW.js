import{u as T,r as h,j as e,C as _}from"./index-CCBHo-lD.js";import{C as v,a as l}from"./CRow-C3lqLwZH.js";import{C as d,a as o}from"./CCardBody-CyLBBCR7.js";import{C as S,a as D,b as x,c as a,d as k,e as t}from"./CTable-DfilwN4r.js";const L=()=>{const u=T(),j="https://condoease-backends.onrender.com",[m,g]=h.useState([]),[p,C]=h.useState(!0),[c,f]=h.useState({total:0,pending:0,ongoing:0,completed:0,archived:0});h.useEffect(()=>{(async()=>{try{const i=await fetch(`${j}/api/maintenance-requests`,{headers:{Authorization:`Bearer ${localStorage.getItem("authToken")}`}});if(!i.ok){const n=await i.json();throw new Error(n.error||"Failed to fetch maintenance requests")}const r=await i.json();g(r.requests);const b=r.requests.length,R=r.requests.filter(n=>n.status==="pending").length,N=r.requests.filter(n=>n.status==="ongoing").length,y=r.requests.filter(n=>n.status==="completed").length,w=r.requests.filter(n=>n.status==="archived").length;f({total:b,pending:R,ongoing:N,completed:y,archived:w})}catch(i){console.error("Error fetching maintenance requests:",i)}finally{C(!1)}})()},[j]);const q=s=>{u(`/maintenance-request/${s}`)};return e.jsxs("div",{className:"container",style:{padding:"20px"},children:[e.jsx("h4",{className:"mb-3",children:"Maintenance Tracking"}),e.jsxs(v,{className:"mb-4",children:[e.jsx(l,{md:3,children:e.jsx(d,{className:"border-primary",children:e.jsxs(o,{children:[e.jsx("h6",{children:"Total Requests"}),e.jsx("h4",{children:c.total})]})})}),e.jsx(l,{md:3,children:e.jsx(d,{className:"border-warning",children:e.jsxs(o,{children:[e.jsx("h6",{children:"Pending Requests"}),e.jsx("h4",{children:c.pending})]})})}),e.jsx(l,{md:3,children:e.jsx(d,{className:"border-info",children:e.jsxs(o,{children:[e.jsx("h6",{children:"Ongoing Requests"}),e.jsx("h4",{children:c.ongoing})]})})}),e.jsx(l,{md:3,children:e.jsx(d,{className:"border-success",children:e.jsxs(o,{children:[e.jsx("h6",{children:"Completed Requests"}),e.jsx("h4",{children:c.completed})]})})}),e.jsx(l,{md:3,children:e.jsx(d,{className:"border-secondary",children:e.jsxs(o,{children:[e.jsx("h6",{children:"Archived/Closed Requests"}),e.jsx("h4",{children:c.archived})]})})})]}),e.jsxs(S,{striped:!0,hover:!0,responsive:!0,children:[e.jsx(D,{children:e.jsxs(x,{children:[e.jsx(a,{children:"Request ID"}),e.jsx(a,{children:"Tenant Fullname"}),e.jsx(a,{children:"Maintenance Type"}),e.jsx(a,{children:"Category"}),e.jsx(a,{children:"Status"}),e.jsx(a,{children:"Date Created"}),e.jsx(a,{children:"Action"})]})}),e.jsx(k,{children:p?e.jsx(x,{children:e.jsx(t,{colSpan:"7",className:"text-center",children:"Loading maintenance requests..."})}):m.length===0?e.jsx(x,{children:e.jsx(t,{colSpan:"7",className:"text-center",children:"No maintenance requests found."})}):m.map(s=>e.jsxs(x,{children:[e.jsx(t,{children:s.maintenance_request_id}),e.jsxs(t,{children:[s.first_name," ",s.last_name]}),e.jsx(t,{children:s.maintenance_type}),e.jsx(t,{children:s.category}),e.jsx(t,{children:s.status}),e.jsx(t,{children:new Date(s.created_at).toLocaleDateString()}),e.jsx(t,{children:e.jsx(_,{color:"info",size:"sm",className:"me-2",onClick:()=>q(s.maintenance_request_id),children:"View"})})]},s.maintenance_request_id))})]})]})};export{L as default};
