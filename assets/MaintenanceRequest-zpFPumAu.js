import{v as f,u as C,r as n,j as e,C as h}from"./index-K-Ynpg65.js";import{C as S,a as N}from"./CCardBody-BqKb271J.js";import{C as b}from"./CCardHeader-DZW6CvTF.js";import{C as A}from"./CFormSelect-B6HVnAZv.js";import{C as R}from"./CFormTextarea-BzWD4xsJ.js";import"./CFormControlWrapper-Dukpu5Xk.js";const T=()=>{const{requestId:i}=f(),o=C(),a="https://condoease-backends.onrender.com",[r,u]=n.useState(null),[x,m]=n.useState(!0),[l,g]=n.useState(""),[c,d]=n.useState("");n.useEffect(()=>{(async()=>{try{const s=await fetch(`${a}/api/maintenance-requests/${i}`,{headers:{Authorization:`Bearer ${localStorage.getItem("authToken")}`}});if(!s.ok){const y=await s.json();throw new Error(y.error||"Failed to fetch request details")}const p=await s.json();u(p),d(p.status)}catch(s){console.error("Error fetching request details:",s)}finally{m(!1)}})()},[a,i]);const j=async()=>{try{const t=await fetch(`${a}/api/maintenance-requests/${i}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("authToken")}`},body:JSON.stringify({status:c,comment:l})});if(!t.ok){const s=await t.json();throw new Error(s.error||"Failed to update status")}alert("Status updated successfully!"),o("/collapses")}catch(t){console.error("Error updating status:",t)}};return e.jsxs("div",{className:"container",style:{padding:"20px"},children:[e.jsx("h4",{className:"mb-3",children:"Maintenance Request Details"}),e.jsxs("div",{className:"mb-3",children:[e.jsx("span",{className:"text-body-secondary",style:{cursor:"pointer"},onClick:()=>o("/cards"),children:"DASHBOARD"})," ","/"," ",e.jsx("span",{className:"text-body-secondary",style:{cursor:"pointer"},onClick:()=>o("/collapses"),children:"MAINTENANCE TRACKING"})," ","/ ",e.jsx("span",{style:{color:"#F28D35"},children:"MAINTENANCE REQUEST DETAILS"})]}),x?e.jsx("p",{children:"Loading request details..."}):r?e.jsxs(S,{children:[e.jsxs(b,{children:[e.jsx("h5",{children:"Tenant Request"}),e.jsxs("p",{style:{color:"#888",marginBottom:0},children:[r.maintenance_type," | ",r.category]})]}),e.jsxs(N,{children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Type of Maintenance:"})," ",r.maintenance_type]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Category:"})," ",r.category]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Description:"})," ",r.description]}),r.attachments&&r.attachments.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("p",{children:e.jsx("strong",{children:"Images & Videos:"})}),e.jsx("div",{style:{display:"flex",gap:"10px"},children:r.attachments.map((t,s)=>e.jsx("div",{style:{width:"100px",height:"100px",backgroundColor:"#f0f0f0",borderRadius:"8px",display:"flex",alignItems:"center",justifyContent:"center"},children:t.file_type.startsWith("image")?e.jsx("img",{src:`${a}${t.file_url}`,alt:`Attachment ${s+1}`,style:{maxWidth:"100%",maxHeight:"100%"}}):e.jsx("a",{href:`${a}${t.file_url}`,target:"_blank",rel:"noopener noreferrer",children:t.file_url.split("/").pop()})},s))})]}),e.jsx("div",{className:"mt-4",children:e.jsxs(A,{value:c,onChange:t=>d(t.target.value),style:{borderColor:"#A3C49A",borderRadius:"8px",padding:"10px",fontSize:"16px"},children:[e.jsx("option",{value:"completed",children:"Completed"}),e.jsx("option",{value:"ongoing",children:"Ongoing"})]})}),e.jsxs("div",{className:"mt-3",children:[e.jsx("h6",{children:"Comment"}),e.jsx(R,{rows:"3",value:l,onChange:t=>g(t.target.value),placeholder:"Add your comment here...",style:{borderColor:"#A3C49A",borderRadius:"8px",padding:"10px",fontSize:"16px"}})]}),e.jsxs("div",{className:"d-flex justify-content-end mt-4",children:[e.jsx(h,{color:"secondary",className:"me-2",onClick:()=>o("/collapses"),style:{borderRadius:"8px",padding:"10px 20px",fontSize:"16px"},children:"Cancel"}),e.jsx(h,{color:"warning",onClick:j,style:{borderRadius:"8px",padding:"10px 20px",fontSize:"16px",backgroundColor:"#F28D35",borderColor:"#F28D35"},children:"Send Decision"})]})]})]}):e.jsx("p",{children:"Request not found."})]})};export{T as default};
