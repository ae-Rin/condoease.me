import{v as j,r as n,j as e,C as d}from"./index-CtLSwhzW.js";import{C as g,a as f}from"./CCardBody-Cb-0cdZl.js";import{C}from"./CCardHeader-BLO5Cncy.js";import{C as y}from"./CFormTextarea-CZ_885U9.js";import"./CFormControlWrapper-CF8IwN39.js";const S=()=>{const{requestId:o}=j(),a="https://condoease-backends.onrender.com",[s,h]=n.useState(null),[m,u]=n.useState(!0),[i,p]=n.useState("");n.useEffect(()=>{(async()=>{try{const t=await fetch(`${a}/api/maintenance-requests/${o}`,{headers:{Authorization:`Bearer ${localStorage.getItem("authToken")}`}});if(!t.ok){const x=await t.json();throw new Error(x.error||"Failed to fetch request details")}const c=await t.json();h(c)}catch(t){console.error("Error fetching request details:",t)}finally{u(!1)}})()},[a,o]);const l=async r=>{try{const t=await fetch(`${a}/api/maintenance-requests/${o}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("authToken")}`},body:JSON.stringify({status:r,comment:i})});if(!t.ok){const c=await t.json();throw new Error(c.error||"Failed to update status")}alert("Status updated successfully!")}catch(t){console.error("Error updating status:",t)}};return e.jsx("div",{className:"container",style:{padding:"20px"},children:m?e.jsx("p",{children:"Loading request details..."}):s?e.jsxs(g,{children:[e.jsx(C,{children:e.jsx("h5",{children:"Maintenance Request Details"})}),e.jsxs(f,{children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Tenant:"})," ",s.first_name," ",s.last_name]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Type:"})," ",s.maintenance_type]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Category:"})," ",s.category]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Description:"})," ",s.description]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Status:"})," ",s.status]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Date Created:"})," ",new Date(s.created_at).toLocaleDateString()]}),s.attachments&&s.attachments.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("p",{children:e.jsx("strong",{children:"Attachments:"})}),e.jsx("ul",{children:s.attachments.map((r,t)=>e.jsx("li",{children:r.file_type.startsWith("image")?e.jsx("img",{src:`${a}${r.file_url}`,alt:`Attachment ${t+1}`,style:{maxWidth:"100%",maxHeight:"300px",marginBottom:"10px"}}):e.jsx("a",{href:`${a}${r.file_url}`,target:"_blank",rel:"noopener noreferrer",children:r.file_url.split("/").pop()})},t))})]}),e.jsx("h6",{children:"Add Comment"}),e.jsx(y,{rows:"3",value:i,onChange:r=>p(r.target.value),placeholder:"Add your comment here..."}),e.jsxs("div",{className:"d-flex justify-content-end mt-3",children:[e.jsx(d,{color:"success",className:"me-2",onClick:()=>l("completed"),children:"Mark as Completed"}),e.jsx(d,{color:"warning",className:"me-2",onClick:()=>l("ongoing"),children:"Mark as Ongoing"})]})]})]}):e.jsx("p",{children:"Request not found."})})};export{S as default};
