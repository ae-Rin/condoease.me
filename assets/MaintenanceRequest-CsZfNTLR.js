import{v as x,r as a,j as e,C as d}from"./index-B_uOWvcZ.js";import{C as g,a as f}from"./CCardBody-BgrwG_ND.js";import{C}from"./CCardHeader-DBllCDGK.js";import{C as y}from"./CFormTextarea-GUVDFlYk.js";import"./CFormControlWrapper-BRKvGmnp.js";const R=()=>{const{requestId:n}=x(),o="https://condoease-backends.onrender.com",[s,h]=a.useState(null),[u,m]=a.useState(!0),[l,p]=a.useState("");a.useEffect(()=>{(async()=>{try{const t=await fetch(`${o}/api/maintenance-requests/${n}`,{headers:{Authorization:`Bearer ${localStorage.getItem("authToken")}`}});if(!t.ok){const j=await t.json();throw new Error(j.error||"Failed to fetch request details")}const i=await t.json();h(i)}catch(t){console.error("Error fetching request details:",t)}finally{m(!1)}})()},[o,n]);const c=async r=>{try{const t=await fetch(`${o}/api/maintenance-requests/${n}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("authToken")}`},body:JSON.stringify({status:r,comment:l})});if(!t.ok){const i=await t.json();throw new Error(i.error||"Failed to update status")}alert("Status updated successfully!")}catch(t){console.error("Error updating status:",t)}};return e.jsx("div",{className:"container",style:{padding:"20px"},children:u?e.jsx("p",{children:"Loading request details..."}):s?e.jsxs(g,{children:[e.jsx(C,{children:e.jsx("h5",{children:"Maintenance Request Details"})}),e.jsxs(f,{children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Tenant:"})," ",s.first_name," ",s.last_name]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Type:"})," ",s.maintenance_type]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Category:"})," ",s.category]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Description:"})," ",s.description]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Status:"})," ",s.status]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Date Created:"})," ",new Date(s.created_at).toLocaleDateString()]}),e.jsx("h6",{children:"Add Comment"}),e.jsx(y,{rows:"3",value:l,onChange:r=>p(r.target.value),placeholder:"Add your comment here..."}),e.jsxs("div",{className:"d-flex justify-content-end mt-3",children:[e.jsx(d,{color:"success",className:"me-2",onClick:()=>c("completed"),children:"Mark as Completed"}),e.jsx(d,{color:"warning",className:"me-2",onClick:()=>c("ongoing"),children:"Mark as Ongoing"}),e.jsx(d,{color:"danger",onClick:()=>c("archived"),children:"Archive"})]})]})]}):e.jsx("p",{children:"Request not found."})})};export{R as default};
