import{u as v,r as h,j as e,C as w}from"./index-BtgxjJUI.js";import{C as _,a as l}from"./CRow-NbDBOQDF.js";import{C as d,a as o}from"./CCardBody-rC3rBxOT.js";import{C as S,a as A,b as x,c as t,d as D,e as a}from"./CTable-B48L7tfr.js";const I=()=>{const j=v(),m="https://condoease-backends.onrender.com",[u,g]=h.useState([]),[p,C]=h.useState(!0),[c,f]=h.useState({total:0,pending:0,ongoing:0,completed:0,archived:0});h.useEffect(()=>{(async()=>{try{const i=await fetch(`${m}/api/maintenance-requests`,{headers:{Authorization:`Bearer ${localStorage.getItem("authToken")}`}});if(!i.ok){const n=await i.json();throw new Error(n.error||"Failed to fetch maintenance requests")}const r=await i.json();g(r.requests);const q=r.requests.length,b=r.requests.filter(n=>n.status==="pending").length,R=r.requests.filter(n=>n.status==="ongoing").length,y=r.requests.filter(n=>n.status==="completed").length,T=r.requests.filter(n=>n.status==="archived").length;f({total:q,pending:b,ongoing:R,completed:y,archived:T})}catch(i){console.error("Error fetching maintenance requests:",i)}finally{C(!1)}})()},[m]);const N=s=>{j(`/maintenance-request/${s}`)};return e.jsxs("div",{className:"container",style:{padding:"20px"},children:[e.jsx("h4",{className:"mb-3",children:"Maintenance Tracking"}),e.jsxs("div",{className:"mb-3",children:[e.jsx("span",{className:"text-body-secondary",style:{cursor:"pointer"},onClick:()=>j("/cards"),children:"DASHBOARD"})," ","/ ",e.jsx("span",{style:{color:"#F28D35"},children:"MAINTENANCE TRACKING"})]}),e.jsxs(_,{className:"mb-4",children:[e.jsx(l,{md:3,children:e.jsx(d,{className:"border-primary",children:e.jsxs(o,{children:[e.jsx("h6",{children:"Total Requests"}),e.jsx("h4",{children:c.total})]})})}),e.jsx(l,{md:3,children:e.jsx(d,{className:"border-warning",children:e.jsxs(o,{children:[e.jsx("h6",{children:"Pending Requests"}),e.jsx("h4",{children:c.pending})]})})}),e.jsx(l,{md:3,children:e.jsx(d,{className:"border-info",children:e.jsxs(o,{children:[e.jsx("h6",{children:"Ongoing Requests"}),e.jsx("h4",{children:c.ongoing})]})})}),e.jsx(l,{md:3,children:e.jsx(d,{className:"border-success",children:e.jsxs(o,{children:[e.jsx("h6",{children:"Completed Requests"}),e.jsx("h4",{children:c.completed})]})})}),e.jsx(l,{md:3,children:e.jsx(d,{className:"border-secondary",children:e.jsxs(o,{children:[e.jsx("h6",{children:"Archived/Closed Requests"}),e.jsx("h4",{children:c.archived})]})})})]}),e.jsxs(S,{striped:!0,hover:!0,responsive:!0,children:[e.jsx(A,{children:e.jsxs(x,{children:[e.jsx(t,{children:"Request ID"}),e.jsx(t,{children:"Tenant Fullname"}),e.jsx(t,{children:"Maintenance Type"}),e.jsx(t,{children:"Category"}),e.jsx(t,{children:"Status"}),e.jsx(t,{children:"Date Created"}),e.jsx(t,{children:"Action"})]})}),e.jsx(D,{children:p?e.jsx(x,{children:e.jsx(a,{colSpan:"7",className:"text-center",children:"Loading maintenance requests..."})}):u.length===0?e.jsx(x,{children:e.jsx(a,{colSpan:"7",className:"text-center",children:"No maintenance requests found."})}):u.map(s=>e.jsxs(x,{children:[e.jsx(a,{children:s.maintenance_request_id}),e.jsxs(a,{children:[s.first_name," ",s.last_name]}),e.jsx(a,{children:s.maintenance_type}),e.jsx(a,{children:s.category}),e.jsx(a,{children:s.status}),e.jsx(a,{children:new Date(s.created_at).toLocaleDateString()}),e.jsx(a,{children:e.jsx(w,{color:"info",size:"sm",className:"me-2",onClick:()=>N(s.maintenance_request_id),children:"View"})})]},s.maintenance_request_id))})]})]})};export{I as default};
