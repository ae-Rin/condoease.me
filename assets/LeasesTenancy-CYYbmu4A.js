import{r as b,_ as U,g as $,R as r,e as y,P as u,j as e,a as q,C as O}from"./index-BMrmDxq4.js";import{C as B,a as V}from"./CCardBody-xRzdJjmg.js";import{C as z}from"./CCardHeader-Cuf6BZ09.js";import{C as G}from"./CForm-B-OhGhn6.js";import{C as o,a as l}from"./CRow-DIxYEgs2.js";import{C as P}from"./CFormSelect-7OEAwNGi.js";import{C as L,a as R}from"./CFormControlWrapper-Bn6RY_8u.js";import{C as p}from"./CFormInput-CvNNOvKd.js";import{C as H}from"./CFormTextarea-CsmJFhwx.js";const f=b.forwardRef((s,m)=>{var{className:C,button:c,feedback:A,feedbackInvalid:N,feedbackValid:D,floatingLabel:F,tooltipFeedback:d,hitArea:v,id:h,indeterminate:j,inline:T,invalid:t,label:a,reverse:n,type:i="checkbox",valid:g}=s,k=U(s,["className","button","feedback","feedbackInvalid","feedbackValid","floatingLabel","tooltipFeedback","hitArea","id","indeterminate","inline","invalid","label","reverse","type","valid"]);const x=b.useRef(null),w=$(m,x);b.useEffect(()=>{x.current&&j&&(x.current.indeterminate=j)},[j,x.current]);const E=()=>r.createElement("input",Object.assign({type:i,className:y(c?"btn-check":"form-check-input",{"is-invalid":t,"is-valid":g,"me-2":v}),id:h},k,{ref:w})),_=()=>r.createElement(R,{describedby:k["aria-describedby"],feedback:A,feedbackInvalid:N,feedbackValid:D,floatingLabel:F,invalid:t,tooltipFeedback:d,valid:g}),S=()=>r.createElement(L,Object.assign({customClassName:y(c?y("btn",c.variant?`btn-${c.variant}-${c.color}`:`btn-${c.color}`,{[`btn-${c.size}`]:c.size},`${c.shape}`):"form-check-label")},h&&{htmlFor:h}),a),I=()=>c?r.createElement(r.Fragment,null,r.createElement(E,null),a&&r.createElement(S,null),r.createElement(_,null)):a?v?r.createElement(r.Fragment,null,r.createElement(E,null),r.createElement(L,Object.assign({customClassName:y("form-check-label stretched-link",C)},h&&{htmlFor:h}),a),r.createElement(_,null)):r.createElement("div",{className:y("form-check",{"form-check-inline":T,"form-check-reverse":n,"is-invalid":t,"is-valid":g},C)},r.createElement(E,null),r.createElement(S,null),r.createElement(_,null)):r.createElement(E,null);return r.createElement(I,null)});f.propTypes=Object.assign({button:u.object,className:u.string,hitArea:u.oneOf(["full"]),id:u.string,indeterminate:u.bool,inline:u.bool,label:u.oneOfType([u.string,u.node]),reverse:u.bool,type:u.oneOf(["checkbox","radio"])},R.propTypes);f.displayName="CFormCheck";const te=()=>{const[s,m]=b.useState({property:"",leaseUnits:!1,unit:"",rentPrice:"",depositPrice:"",tenant:"",tenantEmail:"",startDate:"",endDate:"",leaseDocuments:[],tenancyTerms:"",bills:{gas:!1,electricity:!1,internet:!1,tax:!1}}),[C,c]=b.useState([]),[A,N]=b.useState([]),[D,F]=b.useState([]);b.useEffect(()=>{(async()=>{try{const a=await fetch(`${API_URL}/api/properties`,{headers:{Authorization:`Bearer ${localStorage.getItem("authToken")}`}}),n=await fetch(`${API_URL}/api/property-units`,{headers:{Authorization:`Bearer ${localStorage.getItem("authToken")}`}}),i=await fetch(`${API_URL}/api/tenants`,{headers:{Authorization:`Bearer ${localStorage.getItem("authToken")}`}}),g=await a.json(),k=await n.json(),x=await i.json();c(g),N(k),F(x)}catch(a){console.error("Error fetching data:",a)}})()},[]);const d=t=>{const{name:a,value:n}=t.target;m(i=>({...i,[a]:n}))},v=t=>{const{name:a,checked:n}=t.target;m(i=>({...i,[a]:n,...a==="leaseUnits"&&{unit:""}}))},h=t=>{const{name:a,checked:n}=t.target;m(i=>({...i,bills:{...i.bills,[a]:n}}))},j=t=>{const a=Array.from(t.target.files);m(n=>({...n,leaseDocuments:a}))},T=async t=>{t.preventDefault();const a=new FormData;Object.keys(s).forEach(n=>{n==="bills"?Object.keys(s.bills).forEach(i=>{a.append(`bills[${i}]`,s.bills[i])}):n==="leaseDocuments"?s.leaseDocuments.forEach(i=>a.append("leaseDocuments",i)):a.append(n,s[n])});try{const n=await fetch(`${API_URL}/api/leases`,{method:"POST",body:a,headers:{Authorization:`Bearer ${localStorage.getItem("authToken")}`}});if(!n.ok)throw new Error(await n.text());alert("Lease created successfully!"),m({property:"",leaseUnits:!1,unit:"",rentPrice:"",depositPrice:"",tenant:"",tenantEmail:"",startDate:"",endDate:"",leaseDocuments:[],tenancyTerms:"",bills:{gas:!1,electricity:!1,internet:!1,tax:!1}})}catch(n){console.error(n),alert("Error creating lease.")}};return e.jsxs(q,{className:"mt-5",children:[e.jsx("h4",{className:"mb-4",children:"Create New LeaseSSS"}),e.jsxs(B,{children:[e.jsx(z,{children:e.jsx("strong",{children:"Lease Information"})}),e.jsx(V,{children:e.jsxs(G,{onSubmit:T,children:[e.jsxs(o,{className:"mb-3",children:[e.jsx(l,{md:6,children:e.jsxs(P,{name:"property",value:s.property,onChange:d,required:!0,children:[e.jsx("option",{value:"",children:"Select Property/Building"}),C.map(t=>e.jsx("option",{value:t.property_id,children:t.property_name},t.property_id))]})}),e.jsx(l,{md:6,children:e.jsx(f,{type:"checkbox",name:"leaseUnits",label:"Lease Units",checked:s.leaseUnits,onChange:v})})]}),s.leaseUnits&&e.jsx(o,{className:"mb-3",children:e.jsx(l,{md:12,children:e.jsxs(P,{name:"unit",value:s.unit,onChange:d,required:!0,children:[e.jsx("option",{value:"",children:"Select Unit"}),A.filter(t=>Number(t.property_id)===Number(s.property)&&t.status==="vacant").map(t=>e.jsxs("option",{value:t.property_unit_id,children:[t.unit_number," - ",t.unit_type]},t.property_unit_id))]})})}),e.jsxs(o,{className:"mb-3",children:[e.jsx(l,{md:6,children:e.jsx(p,{type:"number",name:"rentPrice",placeholder:"Rent Price (₱)",value:s.rentPrice,onChange:d,required:!0})}),e.jsx(l,{md:6,children:e.jsx(p,{type:"number",name:"depositPrice",placeholder:"Deposit Price (₱)",value:s.depositPrice,onChange:d,required:!0})})]}),e.jsxs(o,{className:"mb-3",children:[e.jsx(l,{md:6,children:e.jsxs(P,{name:"tenant",value:s.tenant,onChange:d,required:!0,children:[e.jsx("option",{value:"",children:"Select Tenant"}),D.map(t=>e.jsxs("option",{value:t.tenant_id,children:[t.first_name," ",t.last_name]},t.tenant_id))]})}),e.jsx(l,{md:6,children:e.jsx(p,{type:"email",name:"tenantEmail",placeholder:"Tenant Email",value:s.tenantEmail,onChange:d,required:!0})})]}),e.jsxs(o,{className:"mb-3",children:[e.jsx(l,{md:6,children:e.jsx(p,{type:"date",name:"startDate",placeholder:"Start Date of Lease",value:s.startDate,onChange:d,required:!0})}),e.jsx(l,{md:6,children:e.jsx(p,{type:"date",name:"endDate",placeholder:"End Date of Lease",value:s.endDate,onChange:d,required:!0})})]}),e.jsx(o,{className:"mb-3",children:e.jsxs(l,{md:12,children:[e.jsx(p,{type:"file",name:"leaseDocuments",multiple:!0,onChange:j,accept:".jpg,.png,.pdf",required:!0}),e.jsx("small",{className:"text-muted",children:"Upload lease documents. Accepted formats: jpg, png, pdf."})]})}),e.jsx(o,{className:"mb-3",children:e.jsx(l,{md:12,children:e.jsx(H,{name:"tenancyTerms",placeholder:"Tenancy Terms",rows:"3",value:s.tenancyTerms,onChange:d,required:!0})})}),e.jsx(o,{className:"mb-3",children:e.jsxs(l,{md:12,children:[e.jsx("strong",{children:"Bills:"}),e.jsxs(o,{className:"align-items-center mb-2",children:[e.jsx(l,{md:6,children:e.jsx(f,{type:"checkbox",name:"gas",label:"Gas",checked:s.bills.gas,onChange:h})}),e.jsx(l,{md:6,children:e.jsx(p,{type:"number",name:"gasAmount",placeholder:"Amount (₱)",value:s.bills.gasAmount||"",onChange:t=>{const a=t.target.value;a>=0&&m(n=>({...n,bills:{...n.bills,gasAmount:a}}))},min:"0"})})]}),e.jsxs(o,{className:"align-items-center mb-2",children:[e.jsx(l,{md:6,children:e.jsx(f,{type:"checkbox",name:"electricity",label:"Electricity",checked:s.bills.electricity,onChange:h})}),e.jsx(l,{md:6,children:e.jsx(p,{type:"number",name:"electricityAmount",placeholder:"Amount (₱)",value:s.bills.electricityAmount||"",onChange:t=>{const a=t.target.value;a>=0&&m(n=>({...n,bills:{...n.bills,electricityAmount:a}}))},min:"0"})})]}),e.jsxs(o,{className:"align-items-center mb-2",children:[e.jsx(l,{md:6,children:e.jsx(f,{type:"checkbox",name:"internet",label:"Internet",checked:s.bills.internet,onChange:h})}),e.jsx(l,{md:6,children:e.jsx(p,{type:"number",name:"internetAmount",placeholder:"Amount (₱)",value:s.bills.internetAmount||"",onChange:t=>{const a=t.target.value;a>=0&&m(n=>({...n,bills:{...n.bills,internetAmount:a}}))},min:"0"})})]}),e.jsxs(o,{className:"align-items-center mb-2",children:[e.jsx(l,{md:6,children:e.jsx(f,{type:"checkbox",name:"tax",label:"Tax",checked:s.bills.tax,onChange:h})}),e.jsx(l,{md:6,children:e.jsx(p,{type:"number",name:"taxAmount",placeholder:"Amount (₱)",value:s.bills.taxAmount||"",onChange:t=>{const a=t.target.value;a>=0&&m(n=>({...n,bills:{...n.bills,taxAmount:a}}))},min:"0"})})]})]})}),e.jsx("div",{className:"d-flex justify-content-end",children:e.jsx(O,{type:"submit",style:{backgroundColor:"#F28D35",color:"white",fontWeight:"bold"},children:"Create Lease"})})]})})]})]})};export{te as default};
