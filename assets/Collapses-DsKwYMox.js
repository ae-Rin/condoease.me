import{u as T,r as l,j as e,C as w}from"./index-B_uOWvcZ.js";import{C as _,a as o}from"./CRow-BewVznDn.js";import{C as d,a as h}from"./CCardBody-BgrwG_ND.js";import{C as S,a as D,b as x,c as a,d as A,e as n}from"./CTable-rRnYlKRC.js";const B=()=>{const j=T(),m="https://condoease-backends.onrender.com",[u,g]=l.useState([]),[p,C]=l.useState(!0),[i,f]=l.useState({total:0,pending:0,ongoing:0,completed:0});l.useEffect(()=>{(async()=>{try{const r=await fetch(`${m}/api/maintenance-requests`,{headers:{Authorization:`Bearer ${localStorage.getItem("authToken")}`}});if(!r.ok){const t=await r.json();throw new Error(t.error||"Failed to fetch maintenance requests")}const c=await r.json();g(c.requests);const b=c.requests.length,q=c.requests.filter(t=>t.status==="pending").length,R=c.requests.filter(t=>t.status==="ongoing").length,y=c.requests.filter(t=>t.status==="completed").length;f({total:b,pending:q,ongoing:R,completed:y})}catch(r){console.error("Error fetching maintenance requests:",r)}finally{C(!1)}})()},[m]);const N=s=>{j(`/maintenance-request/${s}`)};return e.jsxs("div",{className:"container",style:{padding:"20px"},children:[e.jsx("h4",{className:"mb-3",children:"Maintenance Tracking"}),e.jsxs("div",{className:"mb-3",children:[e.jsx("span",{className:"text-body-secondary",style:{cursor:"pointer"},onClick:()=>j("/cards"),children:"DASHBOARD"})," ","/ ",e.jsx("span",{style:{color:"#F28D35"},children:"MAINTENANCE TRACKING"})]}),e.jsxs(_,{className:"mb-4",children:[e.jsx(o,{md:3,children:e.jsx(d,{className:"border-primary",children:e.jsxs(h,{children:[e.jsx("h6",{children:"Total Requests"}),e.jsx("h4",{children:i.total})]})})}),e.jsx(o,{md:3,children:e.jsx(d,{className:"border-warning",children:e.jsxs(h,{children:[e.jsx("h6",{children:"Pending Requests"}),e.jsx("h4",{children:i.pending})]})})}),e.jsx(o,{md:3,children:e.jsx(d,{className:"border-info",children:e.jsxs(h,{children:[e.jsx("h6",{children:"Ongoing Requests"}),e.jsx("h4",{children:i.ongoing})]})})}),e.jsx(o,{md:3,children:e.jsx(d,{className:"border-success",children:e.jsxs(h,{children:[e.jsx("h6",{children:"Completed Requests"}),e.jsx("h4",{children:i.completed})]})})})]}),e.jsxs(S,{striped:!0,hover:!0,responsive:!0,children:[e.jsx(D,{children:e.jsxs(x,{children:[e.jsx(a,{children:"Request ID"}),e.jsx(a,{children:"Tenant Fullname"}),e.jsx(a,{children:"Maintenance Type"}),e.jsx(a,{children:"Category"}),e.jsx(a,{children:"Status"}),e.jsx(a,{children:"Date Created"}),e.jsx(a,{children:"Action"})]})}),e.jsx(A,{children:p?e.jsx(x,{children:e.jsx(n,{colSpan:"7",className:"text-center",children:"Loading maintenance requests..."})}):u.length===0?e.jsx(x,{children:e.jsx(n,{colSpan:"7",className:"text-center",children:"No maintenance requests found."})}):u.map(s=>e.jsxs(x,{children:[e.jsx(n,{children:s.maintenance_request_id}),e.jsxs(n,{children:[s.first_name," ",s.last_name]}),e.jsx(n,{children:s.maintenance_type}),e.jsx(n,{children:s.category}),e.jsx(n,{children:s.status}),e.jsx(n,{children:new Date(s.created_at).toLocaleDateString()}),e.jsx(n,{children:e.jsx(w,{color:"info",size:"sm",className:"me-2",onClick:()=>N(s.maintenance_request_id),children:"View"})})]},s.maintenance_request_id))})]})]})};export{B as default};
