import{v as f,u as C,r as n,j as e,C as p}from"./index-DpFlNDoN.js";import{C as v,a as A}from"./CCardBody-DYK4wXIl.js";import{C as N}from"./CCardHeader-yupTZOHZ.js";import{C as S}from"./CFormSelect-DtLzBbar.js";import{C as b}from"./CFormTextarea-BerY1Exv.js";import"./CFormControlWrapper-CjzzmBZ9.js";const T=()=>{const{requestId:i}=f(),o=C(),r="https://condoease-backends.onrender.com",[s,u]=n.useState(null),[m,x]=n.useState(!0),[c,j]=n.useState(""),[l,d]=n.useState("");n.useEffect(()=>{(async()=>{try{const a=await fetch(`${r}/api/maintenance-requests/${i}`,{headers:{Authorization:`Bearer ${localStorage.getItem("authToken")}`}});if(!a.ok){const y=await a.json();throw new Error(y.error||"Failed to fetch request details")}const h=await a.json();u(h),d(h.status)}catch(a){console.error("Error fetching request details:",a)}finally{x(!1)}})()},[r,i]);const g=async()=>{try{const t=await fetch(`${r}/api/maintenance-requests/${i}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("authToken")}`},body:JSON.stringify({status:l,comment:c})});if(!t.ok){const a=await t.json();throw new Error(a.error||"Failed to update status")}alert("Status updated successfully!"),o("/collapses")}catch(t){console.error("Error updating status:",t)}};return e.jsxs("div",{className:"container",style:{padding:"20px"},children:[e.jsx("h4",{className:"mb-3",children:"Maintenance Request Details"}),e.jsxs("div",{className:"mb-3",children:[e.jsx("span",{className:"text-body-secondary",style:{cursor:"pointer"},onClick:()=>o("/cards"),children:"DASHBOARD"})," ","/ ",e.jsx("span",{className:"text-body-secondary",style:{cursor:"pointer"},onClick:()=>o("/collapses"),children:"MAINTENANCE TRACKING"})," ","/ ",e.jsx("span",{style:{color:"#F28D35"},children:"MAINTENANCE REQUEST DETAILS"})]}),m?e.jsx("p",{children:"Loading request details..."}):s?e.jsxs(v,{children:[e.jsxs(N,{children:[e.jsxs("h5",{children:["Tenant: ",s.first_name," ",s.last_name]}),e.jsxs("p",{style:{color:"#888",marginBottom:0},children:[s.maintenance_type," | ",s.category]})]}),e.jsxs(A,{children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Type of Maintenance:"})," ",s.maintenance_type]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Category:"})," ",s.category]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Description:"})," ",s.description]}),s.attachments&&s.attachments.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("p",{children:e.jsx("strong",{children:"Images & Videos:"})}),e.jsx("div",{style:{display:"flex",gap:"10px"},children:s.attachments.map((t,a)=>e.jsx("div",{style:{width:"100px",height:"100px",backgroundColor:"#f0f0f0",borderRadius:"8px",display:"flex",alignItems:"center",justifyContent:"center"},children:t.file_type.startsWith("image")?e.jsx("img",{src:`${r}${t.file_url}`,alt:`Attachment ${a+1}`,style:{maxWidth:"100%",maxHeight:"100%"}}):e.jsx("a",{href:`${r}${t.file_url}`,target:"_blank",rel:"noopener noreferrer",children:t.file_url.split("/").pop()})},a))})]}),e.jsx("div",{className:"mt-4",children:e.jsxs(S,{value:l,onChange:t=>d(t.target.value),style:{borderColor:"#A3C49A",borderRadius:"8px",padding:"10px",fontSize:"16px"},children:[e.jsx("option",{value:"approved",children:"Approve"}),e.jsx("option",{value:"rejected",children:"Reject"})]})}),e.jsxs("div",{className:"mt-3",children:[e.jsx("h6",{children:"Comment"}),e.jsx(b,{rows:"3",value:c,onChange:t=>j(t.target.value),placeholder:"Add your comment here...",style:{borderColor:"#A3C49A",borderRadius:"8px",padding:"10px",fontSize:"16px"}})]}),e.jsxs("div",{className:"d-flex justify-content-end mt-4",children:[e.jsx(p,{color:"secondary",className:"me-2",onClick:()=>o("/collapses"),style:{fontWeight:"bold"},children:"Cancel"}),e.jsx(p,{onClick:g,style:{backgroundColor:"#F28D35",color:"white",fontWeight:"bold"},children:"Send Decision"})]})]})]}):e.jsx("p",{children:"Request not found."})]})};export{T as default};
